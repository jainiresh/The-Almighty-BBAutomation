"use strict";(self.webpackChunkensemble_client=self.webpackChunkensemble_client||[]).push([[552],{96552:function(e,r,i){i.r(r),i.d(r,{default:function(){return R}});var n,o=i(4942),t=i(72791),v=i(39230),l=i(59434),a=i(57689),u=i(26342),d=i(18298),E=i(27029),c=i(31609),b=i(29439),s=i(30168),p=i(45984),N=i(45726),_=(0,p.Ps)(n||(n=(0,s.Z)(["\n  mutation CreateReviewMutation($portalId: String) {\n    createReview(\n      reviewCollectionId: $portalId\n      attributes: { layoutType: GRID, actionType: null }\n    ) {\n      review {\n        publicId\n      }\n      errors\n    }\n  }\n"])));var T=i(66893),Z=i(52662),I=i(85885);function R(){var e=function(){var e=(0,N.Db)(_),r=(0,b.Z)(e,2),i=r[0],n=i.data,o=i.fetching,v=i.error,l=r[1],a=null;null!==n&&void 0!==n&&n.createReview.errors&&null!==n&&void 0!==n&&n.createReview.errors.length?a=null!==n&&void 0!==n&&n.createReview.errors.includes("REVIEW_COLLECTION_NOT_FOUND")?"error.invalid_portal":"error.invalid_subscription":(null!==v&&void 0!==v&&v.networkError||null!==v&&void 0!==v&&v.graphQLErrors)&&(a="error.create_review_error");var u=(0,t.useCallback)((function(e){return l(e,{additionalTypenames:["ReviewCollection"]})}),[l]);return{review:null===n||void 0===n?void 0:n.createReview.review,isCreatingReview:o,createReview:u,error:a}}(),r=e.review,i=e.isCreatingReview,n=e.createReview,s=e.error,p=(0,l.v9)(I.HF),R=(0,l.v9)(Z.BX),f=(0,v.$G)().t,S=(0,E.Fn)(),w=S.fireEvent,A=S.fireErrorEvent,M=S.fireGroupIdentifySet,D=S.fireUserAdd,U=(0,a.s0)(),O=(0,a.TH)().state,C=null===O||void 0===O?void 0:O.portalId,L=(0,d.G)().isMinTablet;return(0,t.useEffect)((function(){if(L){if(i||r||s||n({portalId:C}),s){var e=C?"/portals/".concat(C):"/";U(e,{replace:!0}),(0,u.t6)({message:f(s),type:"error"}),A(s)}}else{var o=C?"/portals/".concat(C):"/";U(o,{replace:!0})}}),[n,f,C,r,i,s,U,L,A]),(0,t.useEffect)((function(){if(r&&!s){var e,i,n,t;w({eventName:E.B_.REVIEW_CREATED,optionalEventProperties:(0,o.Z)({},E.r8.PARENT,C||"null"),groups:(0,o.Z)({},E.YT.REVIEW,null===r||void 0===r?void 0:r.publicId),additionalGroupProperties:(e={},(0,o.Z)(e,E.YT.PORTAL,C),(0,o.Z)(e,E.YT.WORKSPACE,null===R||void 0===R?void 0:R.id),e)}),M({groupType:E.YT.REVIEW,groupName:null===r||void 0===r?void 0:r.publicId,propertyValues:(t={},(0,o.Z)(t,E.vb.STATUS,"Draft"),(0,o.Z)(t,E.vb.NUM_EDITS,0),(0,o.Z)(t,E.vb.PASSPHRASE_ENABLED,r.passwordProtected||!1),(0,o.Z)(t,E.vb.TITLE,(null===(i=r.title)||void 0===i?void 0:i.length)||0),(0,o.Z)(t,E.vb.DESCRIPTION,(null===(n=r.description)||void 0===n?void 0:n.length)||0),(0,o.Z)(t,E.vb.NUM_DOWNLOADS,0),(0,o.Z)(t,E.vb.NUM_NOTES,0),(0,o.Z)(t,E.vb.COMMENTS_ENABLED,r.commentsEnabled||!0),(0,o.Z)(t,E.vb.DOWNLOADS_ENABLED,r.downloadEnabled||!0),(0,o.Z)(t,E.vb.ACTION_TYPE,"DEFAULT"),(0,o.Z)(t,E.vb.DUE_DATE_ENABLED,!!r.dueDate),(0,o.Z)(t,E.vb.LAYOUT,(0,c.xo)(r.layoutType)||"Walkthrough"),(0,o.Z)(t,E.vb.NUM_ASSIGNEES,0),(0,o.Z)(t,E.vb.NUM_ACTIONS,0),(0,o.Z)(t,E.vb.NUM_COMMENTS,0),(0,o.Z)(t,E.vb.NUM_REVIEWERS,0),(0,o.Z)(t,E.vb.NUM_ITEMS,0),(0,o.Z)(t,E.vb.NUM_IMAGES,0),(0,o.Z)(t,E.vb.NUM_VIDEOS,0),(0,o.Z)(t,E.vb.NUM_AUDIO,0),(0,o.Z)(t,E.vb.NUM_RAW,0),(0,o.Z)(t,E.vb.NUM_PDFS,0),(0,o.Z)(t,E.vb.NUM_DOCS,0),(0,o.Z)(t,E.vb.NUM_WEB,0),(0,o.Z)(t,E.vb.NUM_ARCHIVE,0),(0,o.Z)(t,E.vb.TOTAL_SIZE,0),t)}),null!==p&&void 0!==p&&p.sub&&D(p.sub,(0,o.Z)({},E.OE.NUM_REVIEWS_CREATED,1));var v=(0,T.o)({reviewId:null===r||void 0===r?void 0:r.publicId});U("".concat(v,"/new"),{replace:!0})}}),[R,w,M,D,r,U,C,s,null===p||void 0===p?void 0:p.sub]),null}},66893:function(e,r,i){function n(e){var r=e.reviewId;return"/reviews/".concat(r)}i.d(r,{o:function(){return n}})}}]);